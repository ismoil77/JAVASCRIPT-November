*
API веб-хранилища
API веб-хранилища предоставляет механизмы, с помощью которых браузеры могут хранить пары ключ/значение гораздо более интуитивно понятным способом, чем использование файлов cookie .

Концепции и использование веб-хранилища
В веб-хранилище используются следующие два механизма:

sessionStorageподдерживает отдельную область хранения для каждого данного источника, доступную на время сеанса страницы (пока браузер открыт, включая перезагрузку и восстановление страницы).
Сохраняет данные только для сеанса, то есть данные сохраняются до тех пор, пока браузер (или вкладка) не будет закрыт.
Данные никогда не передаются на сервер.
Ограничение хранения превышает размер файла cookie (максимум 5 МБ).
localStorageделает то же самое, но сохраняется, даже когда браузер закрывается и снова открывается.
Хранит данные без срока действия и очищается только с помощью JavaScript или очистки кеша браузера/локально сохраненных данных.
Предел хранения является максимальным из двух.
Эти механизмы доступны через свойства Window.sessionStorageand Window.localStorage(точнее, Windowобъект реализует объекты WindowLocalStorageand WindowSessionStorage, от которых зависят свойства localStorageand sessionStorage) — вызов одного из них создаст экземпляр объекта Storage, с помощью которого можно устанавливать и извлекать элементы данных. и удален. sessionStorageДля и для каждого источника используется отдельный объект Storage localStorage— они функционируют и управляются отдельно.

Примечание. В Firefox при сбое или перезапуске браузера во избежание проблем с памятью, вызванных чрезмерным использованием веб-хранилища, объем данных, сохраняемых для каждого источника, ограничивается 10 МБ. Дополнительную информацию см. в разделе «Квоты хранения и критерии выселения» .

Примечание. Доступ к веб-хранилищу из сторонних IFrames запрещен, если пользователь отключил сторонние файлы cookie .

Определение доступа к хранилищу третьей стороной
У каждого источника есть свое хранилище — это справедливо как для веб-хранилища, так и для общего хранилища ). Однако доступ стороннего (то есть встроенного) кода к общему хранилищу зависит от контекста его просмотра . Контекст, в котором выполняется сторонний код из другого источника, определяет доступ к хранилищу стороннего кода.

Блок-диаграмма, показывающая контекст просмотра верхнего уровня под названиемPublisher.com со встроенным в него сторонним контентом.
Сторонний код можно добавить на другой сайт, внедрив в него элемент <script>или указав в качестве источника сайта <iframe>сайт, содержащий сторонний код. Метод, используемый для интеграции стороннего кода, определяет контекст просмотра кода.

Если ваш сторонний код добавляется на другой сайт с <script>элементом, ваш код будет выполнен в контексте просмотра средства внедрения. Поэтому при вызове Storage.setItem()или SharedStorage.set()пара ключ/значение будет записана в хранилище средства внедрения. <script>С точки зрения браузера, при использовании тега нет разницы между собственным кодом и сторонним кодом .
Когда ваш сторонний код добавляется на другой сайт в файле <iframe>, код внутри <iframe>будет выполняться с источником <iframe>контекста просмотра . Если код внутри <iframe>вызывает Storage.setItem(), данные будут записаны в локальное или сеансовое хранилище источника <iframe>. Если <iframe>код вызывает SharedStorage.set(), данные будут записаны в общее хранилище источника <iframe>.
Интерфейсы веб-хранилища
Storage
Позволяет устанавливать, получать и удалять данные для определенного домена и типа хранилища (сеансовое или локальное).

Window
API веб-хранилища расширяет Windowобъект двумя новыми свойствами — Window.sessionStorageи Window.localStorage— которые обеспечивают доступ к текущему сеансу домена и локальным Storageобъектам соответственно, а также storageобработчиком событий, который срабатывает при изменении области хранения (например, при сохранении нового элемента).

StorageEvent
Событие storageвызывается для объекта документа Windowпри изменении области хранения.

Примеры
Чтобы проиллюстрировать типичное использование веб-хранилища, мы создали простой пример, образно названный « Демоверсия веб-хранилища» . На целевой странице имеются элементы управления, которые можно использовать для настройки цвета, шрифта и декоративного изображения. При выборе разных вариантов страница мгновенно обновляется; Кроме того, ваш выбор сохраняется в файле localStorage, поэтому, когда вы покидаете страницу, а затем загружаете ее снова, ваш выбор запоминается.
*